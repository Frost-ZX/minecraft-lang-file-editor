(function(){"use strict";var t={238:function(t,e,n){var o=n(702),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("lang-actions",{attrs:{position:"top"},on:{"unicode-convert":t.handleUnicodeConvert}}),n("lang-editor",{ref:"langEditor"}),n("lang-actions",{attrs:{position:"bottom"}})],1)},i=[],s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"lang-actions"},[n("div",{staticClass:"wrapper"},["top"===t.position?[n("b-button",{attrs:{type:"is-primary"},on:{click:function(e){return t.selectFile()}}},[t._v("添加文件")]),n("input",{ref:"inputFile",staticClass:"input-file",attrs:{type:"file",accept:"application/json"},on:{change:function(e){return t.getLangFile(e)}}}),n("b-button",{attrs:{type:"is-success",disabled:!t.langCodeEdit},on:{click:function(e){return t.exportFile()}}},[t._v("保存文件")]),n("b-button",{attrs:{type:"is-danger"},on:{click:function(e){return t.resetData()}}},[t._v("重置数据")]),n("div",{staticClass:"lang-select"},[n("b-tooltip",{attrs:{label:"来源语言",position:"is-bottom",type:"is-dark"}},[n("b-select",{model:{value:t.langCodeSrc,callback:function(e){t.langCodeSrc=e},expression:"langCodeSrc"}},[n("option",{attrs:{value:""}},[t._v("无")]),t._l(t.langCodes,(function(e){return n("option",{key:e,domProps:{value:e}},[t._v(t._s(e))])}))],2)],1),n("b-tooltip",{attrs:{label:"编辑语言",position:"is-bottom",type:"is-dark"}},[n("b-select",{model:{value:t.langCodeEdit,callback:function(e){t.langCodeEdit=e},expression:"langCodeEdit"}},[n("option",{attrs:{value:""}},[t._v("无")]),t._l(t.langCodes,(function(e){return n("option",{key:e,domProps:{value:e}},[t._v(t._s(e))])}))],2)],1),n("b-tooltip",{staticClass:"lang-transfer",attrs:{label:"互换",position:"is-bottom",type:"is-dark"}},[n("b-button",{attrs:{type:"is-info","icon-right":"arrow-left-right"},on:{click:function(e){return t.transferLangCode()}}})],1)],1),n("b-button",{attrs:{type:"is-light"},on:{click:function(e){return t.$emit("unicode-convert","encode")}}},[t._v("Unicode 编码")]),n("b-button",{attrs:{type:"is-light"},on:{click:function(e){return t.$emit("unicode-convert","decode")}}},[t._v("Unicode 解码")])]:"bottom"===t.position?[n("b-pagination",{attrs:{"per-page":t.pageSize,total:t.totalSize,"range-before":2,"range-after":2,"debounce-page-input":500,order:"is-centered","page-input-position":"is-input-right","page-input":""},model:{value:t.pageNum,callback:function(e){t.pageNum=e},expression:"pageNum"}}),n("b-select",{model:{value:t.pageSize,callback:function(e){t.pageSize=e},expression:"pageSize"}},t._l(t.pageSizeList,(function(e){return n("option",{key:e,domProps:{value:e}},[t._v(t._s(e)+" 条 / 页")])})),0)]:t._e()],2)])},r=[],l=n(227),c=n(906),u=n(132),g=n.n(u),d=n(222);class p{constructor(){}objPagination(t){const{obj:e=null,pageNum:n=1,pageSize:o=20}=t,a=e&&e.constructor===Object&&"number"===typeof n&&"number"===typeof o;if(!a)return console.error("获取数据失败，参数格式错误！"),null;const i=(n-1)*o,s=i+o,r=Object.keys(e),l=r.slice(i,s),c=r.length,u=l.length,g={};return l.forEach((t=>{g[t]=e[t]})),{obj:g,maxPage:Math.ceil(c/o),currPage:n,startPos:i+1,endPos:s,maxSize:c,currSize:u}}readFileAsText(t,e){const n=[],o=t.currentTarget,a=o.files;if(!a||0===a.length)return Promise.resolve(n);const i=(t,i)=>{const s=[];for(let e=0;e<a.length;e++){const t=a[e],n=new FileReader,o=(e,o)=>{n.onload=()=>{e({name:t.name||"unknown",content:n.result})},n.onerror=()=>{o({name:t.name||"unknown",content:null})},n.readAsText(t)};s.push(new Promise(o))}Promise.all(s).then((n=>{t(n),e&&(o["value"]="")})).catch((()=>{i(n)}))};return new Promise(i)}toast(t){const{duration:e=2e3,indefinite:n=!1,message:o="",type:a="is-info"}=t;return d.V.open({duration:e,indefinite:n,message:o,pauseOnHover:!0,type:a})}uniDecode(t=""){if("string"!==typeof t)return console.error("转换失败，参数数据类型错误！"),null;if(""===t)return"";const e=new RegExp("\\\\u","g"),n=t.replace(e,"%u");try{return unescape(n)}catch(o){return console.error("转换失败",o),null}}uniEncode(t=""){if("string"!==typeof t)return console.error("转换失败，参数数据类型错误！"),null;if(""===t)return"";const e=[];for(let n=0;n<t.length;n++)e.push(t.charCodeAt(n).toString(16).padStart(4,"0"));return"\\u"+e.join("\\u")}}const f=new p;var m=f;function h(){return(new Date).getTime()}o.Z.use(c.ZP);var b=new c.ZP.Store({state:{langCodes:[],langCodeEdit:"",langCodeSrc:"",langItemsDefault:{},langItemsEdit:{},langItemsUpdates:h(),pageNum:1,pageSize:20,totalSize:0},getters:{},mutations:{changePageNum(t,e){t.pageNum="number"===typeof e?e:1},changePageSize(t,e){t.pageSize="number"===typeof e?e:20},changeTotalSize(t,e){t.totalSize="number"===typeof e?e:0},resetLangItems(t){t.langCodeEdit="",t.langCodeSrc="",t.langCodes=[],t.pageNum=1,t.totalSize=0,t.langItemsDefault={},t.langItemsEdit={},t.langItemsUpdates=h()},setLangCode(t,e={}){const{type:n,code:o}=e,a="string"===typeof n&&"string"===typeof o;if(!a)return console.error("设置失败，参数格式错误！"),!1;if("src"===n)t.langCodeSrc=o;else{if("edit"!==n)return console.error("设置失败，type 不存在。"),!1;t.langCodeEdit=o}return!0},syncLangItems(t,e){e&&e.constructor===Object?t.langItemsEdit=e:console.error("同步失败，参数格式错误！")}},actions:{addLangItem(t,e={}){const n={success:!1,msg:""},{state:o}=t,{langCode:a,content:i}=e,s="string"===typeof a&&"undefined"!==typeof i&&i.constructor===Object;if(!s)return n.msg="添加失败，参数格式错误！",n;const{langCodes:r,langItemsDefault:l,langItemsEdit:c}=o;if(r.includes(a))return n.msg="当前 Language Code 已存在，取消添加",n;for(let u in i){const t=i[u];if("string"!==typeof t)return n.msg="文件内容格式错误，添加失败。",n;!l[u]&&(l[u]={}),!c[u]&&(c[u]={}),l[u][a]=t,c[u][a]=t}return r.push(a),o.langItemsUpdates=h(),n.success=!0,n.msg="添加成功",n}},modules:{}}),C={name:"LangActions",props:{position:{type:String,default:"top"}},data(){return{pageSizeList:[10,20,30,40,50,100,200,500,1e3]}},computed:{...(0,c.rn)(["langCodes","langItemsEdit","totalSize"]),langCodeSrc:{get(){return b.state.langCodeSrc},set(t){b.commit("setLangCode",{type:"src",code:t})}},langCodeEdit:{get(){return b.state.langCodeEdit},set(t){b.commit("setLangCode",{type:"edit",code:t})}},pageNum:{get(){return b.state.pageNum},set(t){b.commit("changePageNum",t)}},pageSize:{get(){return b.state.pageSize},set(t){b.commit("changePageSize",t)}}},methods:{exportFile(){const{langCodeEdit:t,langItemsEdit:e}=this,n={};for(let a in e){const o=e[a][t];o&&(n[a]=o)}try{const e=JSON.stringify(n),o=e.replace(/\\\\u/g,"\\u"),a=new Blob([o],{type:"application/json;charset=utf-8"});(0,l.saveAs)(a,`${t}.json`)}catch(o){console.error("[保存失败]",o),m.toast({duration:3e3,message:"保存失败！",type:"is-danger"})}},getLangFile(t){m.readFileAsText(t,!0).then((t=>{let e=t[0],n="",o=null;if(!e)return;try{n=e.name.replace(".json","")}catch(r){console.warn("[文件名解析失败]",r)}const a=new RegExp(/\\u/,"g");try{o=e.content.replace(a,"\\\\u"),o=g().parse(o)}catch(r){const t=`JSON 解析失败（${String(r)}）`;return void m.toast({duration:5e3,message:t,type:"is-danger"})}const i=t=>{m.toast({duration:3e3,message:t.msg,type:t.success?"is-success":"is-warning"})},s=t=>{this.$store.dispatch("addLangItem",{langCode:t,content:o}).then(i)};this.$buefy.dialog.prompt({message:"当前文件的 Language Code",inputAttrs:{maxlength:16,placeholder:"例：en_us、zh_cn",value:n},onConfirm:s})}))},selectFile(){const t=this.$refs["inputFile"];t&&t.click()},resetData(){const t=()=>{this.$store.commit("resetLangItems"),m.toast({message:"已重置",type:"is-success"})};this.$buefy.dialog.confirm({message:"确定要重置编辑器的数据吗？",onConfirm:t})},transferLangCode(){const{langCodeEdit:t,langCodeSrc:e}=this;b.commit("setLangCode",{type:"edit",code:e}),b.commit("setLangCode",{type:"src",code:t})}}},y=C,v=n(0),S=(0,v.Z)(y,s,r,!1,null,"c7a078f6",null),E=S.exports,k=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"lang-editor"},[t.isDebug?n("div",{staticClass:"editor-debug"},[n("b-button",{attrs:{type:"is-light"},on:{click:function(e){return t.pullEditDatas()}}},[t._v("拉取 state")]),n("b-button",{attrs:{type:"is-light"},on:{click:function(e){return t.pushEditDatas(!0)}}},[t._v("推送 state")])],1):t._e(),n("div",{staticClass:"editor-content",on:{click:function(e){return t.handleClickContent(e)}}},[t.showLangItems?t._l(t.editDatasPage,(function(e,o,a){return n("div",{key:o,ref:"langItems",refInFor:!0,staticClass:"lang-item",class:{"is-add":!e[t.langCodeSrc]&&e[t.langCodeEdit],"is-del":e[t.langCodeSrc]&&!e[t.langCodeEdit]}},[n("div",{staticClass:"lang-key"},[n("span",{staticClass:"info-label"},[t._v("key:")]),n("span",{staticClass:"info-value"},[t._v(t._s(o))]),n("div",{staticClass:"item-actions"},[n("b-tooltip",{attrs:{label:"复制到剪贴板",position:"is-left",type:"is-dark"}},[n("b-icon",{staticClass:"btn",attrs:{icon:"content-copy"},nativeOn:{click:function(e){return t.copyToClipboard(a)}}})],1),n("b-tooltip",{attrs:{label:"复制到编辑区",position:"is-left",type:"is-dark"}},[n("b-icon",{staticClass:"btn",attrs:{icon:"content-duplicate"},nativeOn:{click:function(n){return t.copyToEdit(e)}}})],1)],1)]),n("b-field",{attrs:{label:t.langCodeSrc}},[n("b-input",{attrs:{readonly:""},model:{value:e[t.langCodeSrc],callback:function(n){t.$set(e,t.langCodeSrc,n)},expression:"langItem[langCodeSrc]"}})],1),n("b-field",{attrs:{label:t.langCodeEdit}},[n("b-input",{attrs:{type:"textarea","custom-class":"is-info","data-key":o,lazy:""},model:{value:e[t.langCodeEdit],callback:function(n){t.$set(e,t.langCodeEdit,n)},expression:"langItem[langCodeEdit]"}})],1)],1)})):t._e()],2)])},_=[],D={name:"LangEditor",data(){return{isDebug:!1,editDatas:null,editDatasPage:null,langKeyEditing:"",lastPushTimestamp:0,paginationDebounce:null}},computed:{...(0,c.rn)(["langCodeSrc","langCodeEdit","langItemsEdit","langItemsUpdates","pageNum","pageSize"]),showLangItems(t){const{langCodeSrc:e,langCodeEdit:n,editDatasPage:o}=t;return e&&n&&o}},watch:{langItemsUpdates:{handler(){console.log("[更新] langItemsUpdates"),this.pullEditDatas()}},pageNum:{handler(){console.log("[更新] pageNum"),this.getPageDatas()}},pageSize:{handler(){console.log("[更新] pageSize"),this.getPageDatas()}}},methods:{copyToClipboard(t=0){let e=this.$refs["langItems"]?.[t],n=null;e&&(n=e.getElementsByTagName("input")[0]),n?(n.focus(),n.select(),document.execCommand("copy")):console.error("复制失败，元素不存在！")},copyToEdit(t={}){const{langCodeEdit:e,langCodeSrc:n}=this,o=t[e];t[e]=t[n]||"","string"!==typeof o&&this.$forceUpdate()},getPageDatas(){clearTimeout(this.paginationDebounce),this.paginationDebounce=setTimeout((()=>{console.log("[更新] getPageDatas");const t=m.objPagination({obj:this.editDatas,pageNum:this.pageNum,pageSize:this.pageSize});t&&(this.editDatasPage=t.obj,this.$store.commit("changeTotalSize",t.maxSize))}),200)},handleClickContent(t){const e=t.target,n=e.dataset.key;this.langKeyEditing="string"===typeof n?n:"",this.pushEditDatas()},pullEditDatas(){this.editDatas=JSON.parse(JSON.stringify(this.langItemsEdit)),this.getPageDatas()},pushEditDatas(t=!1){const e=this.lastPushTimestamp,n=(new Date).getTime(),o=2e4;if(!(t||n-e>=o))return;console.log("[更新] 推送编辑器数据到 state");const a=JSON.parse(JSON.stringify(this.editDatas));this.$store.commit("syncLangItems",a),this.lastPushTimestamp=n},unicodeConvert(t){if("undefined"===typeof window.getSelection)return void m.toast({duration:3e3,message:"操作失败，当前浏览器不支持 getSelection()。",type:"is-warning"});const{editDatas:e,langCodeEdit:n,langKeyEditing:o}=this,a=String(window.getSelection());if(!o||!a)return void m.toast({duration:3e3,message:"请先选中编辑文本。",type:"is-warning"});const i=e[o],s=i[n];if("decode"===t){const t=m.uniDecode(a),e=s.replace(a,t);i[n]=e}else if("encode"===t){const t=m.uniEncode(a),e=s.replace(a,t);i[n]=e}else console.error("操作失败，该 type 不存在。")}}},P=D,w=(0,v.Z)(P,k,_,!1,null,"a7616200",null),I=w.exports,z={name:"App",components:{LangActions:E,LangEditor:I},data(){return{}},methods:{handleUnicodeConvert(t=""){const e=this.$refs["langEditor"],n="unicodeConvert";e&&e[n]?e[n](t):console.error("处理失败，元素或函数不存在！")}}},x=z,L=(0,v.Z)(x,a,i,!1,null,null,null),O=L.exports,N=n(571);n(17);o.Z.config.productionTip=!1,o.Z.use(N.ZP,{defaultIconPack:"mdi",defaultDialogConfirmText:"确定",defaultDialogCancelText:"取消"}),new o.Z({store:b,render:t=>t(O)}).$mount("#app")}},e={};function n(o){var a=e[o];if(void 0!==a)return a.exports;var i=e[o]={exports:{}};return t[o].call(i.exports,i,i.exports,n),i.exports}n.m=t,function(){var t=[];n.O=function(e,o,a,i){if(!o){var s=1/0;for(u=0;u<t.length;u++){o=t[u][0],a=t[u][1],i=t[u][2];for(var r=!0,l=0;l<o.length;l++)(!1&i||s>=i)&&Object.keys(n.O).every((function(t){return n.O[t](o[l])}))?o.splice(l--,1):(r=!1,i<s&&(s=i));if(r){t.splice(u--,1);var c=a();void 0!==c&&(e=c)}}return e}i=i||0;for(var u=t.length;u>0&&t[u-1][2]>i;u--)t[u]=t[u-1];t[u]=[o,a,i]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};n.O.j=function(e){return 0===t[e]};var e=function(e,o){var a,i,s=o[0],r=o[1],l=o[2],c=0;if(s.some((function(e){return 0!==t[e]}))){for(a in r)n.o(r,a)&&(n.m[a]=r[a]);if(l)var u=l(n)}for(e&&e(o);c<s.length;c++)i=s[c],n.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return n.O(u)},o=self["webpackChunkminecraft_lang_file_editor"]=self["webpackChunkminecraft_lang_file_editor"]||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(238)}));o=n.O(o)})();